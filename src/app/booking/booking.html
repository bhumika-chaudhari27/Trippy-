<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Now - Trippy Travel</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="booking-container">
        <div class="booking-header">
            <h2><i class="fas fa-passport"></i> Book Your Dream Trip</h2>
            <p>Let's plan your perfect getaway in just a few simple steps</p>
        </div>

        <form id="bookingForm" class="booking-form">
            <!-- Step Indicator -->
            <div class="step-indicator">
                <div class="step active" data-step="1">1</div>
                <div class="step" data-step="2">2</div>
                <div class="step" data-step="3">3</div>
                <div class="step" data-step="4">4</div>
                <div class="step" data-step="5">5</div>
            </div>

            <!-- Step 1: Destination & Dates -->
            <div class="form-step active" data-step="1">
                <h3 style="margin-bottom: 1.5rem; color: #333;">
                    <i class="fas fa-map-marked-alt"></i> Choose Your Destination & Dates
                </h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="destination">
                            <i class="fas fa-globe"></i> Destination
                        </label>
                        <select id="destination" name="destination" required>
                            <option value="">Select Destination</option>
                            <option value="paris">Paris, France</option>
                            <option value="tokyo">Tokyo, Japan</option>
                            <option value="bali">Bali, Indonesia</option>
                            <option value="newyork">New York, USA</option>
                            <option value="santorini">Santorini, Greece</option>
                            <option value="dubai">Dubai, UAE</option>
                            <option value="custom">Custom Destination</option>
                        </select>
                    </div>
                    <div class="form-group" id="customDestinationGroup" style="display: none;">
                        <label for="customDestination">
                            <i class="fas fa-edit"></i> Custom Destination
                        </label>
                        <input type="text" id="customDestination" name="customDestination" placeholder="Enter your desired destination">
                    </div>
                    <div class="form-group">
                        <label for="departureDate">
                            <i class="fas fa-calendar-alt"></i> Departure Date
                        </label>
                        <input type="date" id="departureDate" name="departureDate" required>
                    </div>
                    <div class="form-group">
                        <label for="returnDate">
                            <i class="fas fa-calendar-check"></i> Return Date
                        </label>
                        <input type="date" id="returnDate" name="returnDate" required>
                    </div>
                    <div class="form-group">
                        <label>
                            <i class="fas fa-users"></i> Number of Travelers
                        </label>
                        <div class="traveler-counter">
                            <button type="button" class="counter-btn" id="decreaseBtn">-</button>
                            <span class="counter-value" id="travelerCount">2</span>
                            <button type="button" class="counter-btn" id="increaseBtn">+</button>
                        </div>
                        <input type="hidden" id="travelers" name="travelers" value="2">
                    </div>
                </div>
            </div>

            <!-- Step 2: Package Selection -->
            <div class="form-step" data-step="2">
                <h3 style="margin-bottom: 1.5rem; color: #333;">
                    <i class="fas fa-box"></i> Choose Your Perfect Package
                </h3>
                <div class="package-selection">
                    <div class="package-card" id="basicPackage">
                        <div class="package-badge">Popular Choice</div>
                        <div style="position: absolute; top: 15px; left: 15px; background: #ff4757; color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.75rem; font-weight: bold;">16% OFF</div>
                        <h4 style="margin-top: 2rem; font-size: 1.5rem; color: #333;">Essential Journey</h4>
                        <div style="text-decoration: line-through; color: #999; font-size: 1rem; margin-bottom: 0.25rem;">₹89,000</div>
                        <div class="package-price">₹75,000</div>
                        <p style="color: #666; margin-bottom: 1rem;">Perfect for budget-conscious travelers</p>
                        <ul class="package-features">
                            <li><i class="fas fa-plane" style="color: #667eea;"></i> Round-trip flights</li>
                            <li><i class="fas fa-bed" style="color: #667eea;"></i> 3-star hotel accommodation</li>
                            <li><i class="fas fa-car" style="color: #667eea;"></i> Airport transfers</li>
                            <li><i class="fas fa-shield-alt" style="color: #667eea;"></i> Basic travel insurance</li>
                            <li><i class="fas fa-gift" style="color: #667eea;"></i> Welcome kit</li>
                        </ul>
                        <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(102, 126, 234, 0.1); border-radius: 8px; font-size: 0.9rem; color: #667eea; text-align: center;">
                            <i class="fas fa-rupee-sign"></i> EMI starting from ₹6,250/month
                        </div>
                    </div>
                    
                    <div class="package-card" id="premiumPackage" style="transform: scale(1.05); border: 3px solid #667eea; box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);">
                        <div class="package-badge" style="background: linear-gradient(135deg, #4CAF50, #45a049);">Best Value</div>
                        <div style="position: absolute; top: 15px; left: 15px; background: #ff4757; color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.75rem; font-weight: bold;">16% OFF</div>
                        <h4 style="margin-top: 2rem; font-size: 1.5rem; color: #333;">Deluxe Experience</h4>
                        <div style="text-decoration: line-through; color: #999; font-size: 1rem; margin-bottom: 0.25rem;">₹1,49,000</div>
                        <div class="package-price">₹1,25,000</div>
                        <p style="color: #666; margin-bottom: 1rem;">Enhanced experience with premium inclusions</p>
                        <ul class="package-features">
                            <li><i class="fas fa-plane" style="color: #4CAF50;"></i> Premium economy flights</li>
                            <li><i class="fas fa-bed" style="color: #4CAF50;"></i> 4-star luxury hotel</li>
                            <li><i class="fas fa-car" style="color: #4CAF50;"></i> All transfers included</li>
                            <li><i class="fas fa-map-marked-alt" style="color: #4CAF50;"></i> Guided city tours</li>
                            <li><i class="fas fa-shield-alt" style="color: #4CAF50;"></i> Comprehensive insurance</li>
                            <li><i class="fas fa-coffee" style="color: #4CAF50;"></i> Daily breakfast</li>
                            <li><i class="fas fa-sim-card" style="color: #4CAF50;"></i> Local SIM card</li>
                            <li><i class="fas fa-headset" style="color: #4CAF50;"></i> 24/7 support</li>
                        </ul>
                        <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(76, 175, 80, 0.1); border-radius: 8px; font-size: 0.9rem; color: #4CAF50; text-align: center;">
                            <i class="fas fa-rupee-sign"></i> EMI starting from ₹10,416/month
                        </div>
                    </div>
                    
                    <div class="package-card" id="luxuryPackage">
                        <div class="package-badge" style="background: linear-gradient(135deg, #FFD700, #FFA500);">Ultimate Luxury</div>
                        <div style="position: absolute; top: 15px; left: 15px; background: #ff4757; color: white; padding: 0.25rem 0.75rem; border-radius: 15px; font-size: 0.75rem; font-weight: bold;">17% OFF</div>
                        <h4 style="margin-top: 2rem; font-size: 1.5rem; color: #333;">Royal Escape</h4>
                        <div style="text-decoration: line-through; color: #999; font-size: 1rem; margin-bottom: 0.25rem;">₹2,39,000</div>
                        <div class="package-price">₹1,99,000</div>
                        <p style="color: #666; margin-bottom: 1rem;">The ultimate royal travel experience</p>
                        <ul class="package-features">
                            <li><i class="fas fa-plane" style="color: #FFD700;"></i> Business class flights</li>
                            <li><i class="fas fa-crown" style="color: #FFD700;"></i> 5-star luxury resort</li>
                            <li><i class="fas fa-car" style="color: #FFD700;"></i> Private chauffeur service</li>
                            <li><i class="fas fa-user-tie" style="color: #FFD700;"></i> Personal tour guide</li>
                            <li><i class="fas fa-shield-alt" style="color: #FFD700;"></i> Premium travel insurance</li>
                            <li><i class="fas fa-utensils" style="color: #FFD700;"></i> All meals included</li>
                            <li><i class="fas fa-spa" style="color: #FFD700;"></i> Spa treatments</li>
                            <li><i class="fas fa-gem" style="color: #FFD700;"></i> VIP lounge access</li>
                            <li><i class="fas fa-star" style="color: #FFD700;"></i> Exclusive experiences</li>
                        </ul>
                        <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(255, 215, 0, 0.1); border-radius: 8px; font-size: 0.9rem; color: #FFA500; text-align: center;">
                            <i class="fas fa-rupee-sign"></i> EMI starting from ₹16,583/month
                        </div>
                    </div>
                </div>
                <input type="hidden" id="selectedPackage" name="selectedPackage" required>
            </div>

            <!-- Step 3: Personal Information -->
            <div class="form-step" data-step="3">
                <h3 style="margin-bottom: 1.5rem; color: #333;">
                    <i class="fas fa-user"></i> Personal Information
                </h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="firstName">
                            <i class="fas fa-user"></i> First Name
                        </label>
                        <input type="text" id="firstName" name="firstName" required>
                    </div>
                    <div class="form-group">
                        <label for="lastName">
                            <i class="fas fa-user"></i> Last Name
                        </label>
                        <input type="text" id="lastName" name="lastName" required>
                    </div>
                    <div class="form-group">
                        <label for="email">
                            <i class="fas fa-envelope"></i> Email Address
                        </label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">
                            <i class="fas fa-phone"></i> Phone Number
                        </label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                    <div class="form-group">
                        <label for="dateOfBirth">
                            <i class="fas fa-birthday-cake"></i> Date of Birth
                        </label>
                        <input type="date" id="dateOfBirth" name="dateOfBirth" required>
                    </div>
                    <div class="form-group">
                        <label for="nationality">
                            <i class="fas fa-flag"></i> Nationality
                        </label>
                        <input type="text" id="nationality" name="nationality" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="address">
                            <i class="fas fa-home"></i> Full Address
                        </label>
                        <textarea id="address" name="address" placeholder="Enter your complete address" required></textarea>
                    </div>
                    <div class="form-group full-width">
                        <label for="specialRequests">
                            <i class="fas fa-comment-alt"></i> Special Requests (Optional)
                        </label>
                        <textarea id="specialRequests" name="specialRequests" placeholder="Any dietary requirements, accessibility needs, or special occasions..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 4: Review & Payment -->
            <div class="form-step" data-step="4">
                <h3 style="margin-bottom: 1.5rem; color: #333;">
                    <i class="fas fa-credit-card"></i> Review & Payment
                </h3>
                
                <div class="booking-summary">
                    <h4 style="margin-bottom: 1rem; color: #333;">
                        <i class="fas fa-list-alt"></i> Booking Summary
                    </h4>
                    <div id="bookingSummaryContent">
                        <!-- Dynamic content will be inserted here -->
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group full-width">
                        <label for="cardNumber">
                            <i class="fas fa-credit-card"></i> Card Number
                        </label>
                        <input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" required>
                    </div>
                    <div class="form-group">
                        <label for="expiryDate">
                            <i class="fas fa-calendar"></i> Expiry Date
                        </label>
                        <input type="text" id="expiryDate" name="expiryDate" placeholder="MM/YY" maxlength="5" required>
                    </div>
                    <div class="form-group">
                        <label for="cvv">
                            <i class="fas fa-lock"></i> CVV
                        </label>
                        <input type="text" id="cvv" name="cvv" placeholder="123" maxlength="4" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="cardName">
                            <i class="fas fa-user"></i> Name on Card
                        </label>
                        <input type="text" id="cardName" name="cardName" required>
                    </div>
                </div>

                <div class="feature-highlight">
                    <label style="display: flex; align-items: flex-start; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="termsAccepted" name="termsAccepted" required style="margin-top: 0.25rem;">
                        <span>I agree to the <a href="#" style="color: #667eea; text-decoration: none;">Terms and Conditions</a> and <a href="#" style="color: #667eea; text-decoration: none;">Privacy Policy</a>. I understand that this booking is subject to availability and final confirmation.</span>
                    </label>
                </div>
            </div>

            <!-- Step 5: Confirmation -->
            <div class="form-step" data-step="5">
                <div class="confirmation-content">
                    <div class="confirmation-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>Booking Confirmed!</h3>
                    <p style="margin-bottom: 1rem;">Thank you for choosing Trippy! Your dream vacation is being prepared.</p>
                    
                    <div class="booking-reference">
                        Booking Reference: <span id="bookingRef">TRP-2024-001234</span>
                    </div>
                    
                    <div style="text-align: left; max-width: 500px; margin: 2rem auto;">
                        <h4 style="margin-bottom: 1rem; color: #333;">What happens next?</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="padding: 0.5rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-envelope" style="color: #667eea;"></i>
                                <span>Confirmation email sent to your inbox</span>
                            </li>
                            <li style="padding: 0.5rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-phone" style="color: #667eea;"></i>
                                <span>Our travel expert will call you within 24 hours</span>
                            </li>
                            <li style="padding: 0.5rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-file-alt" style="color: #667eea;"></i>
                                <span>Detailed itinerary will be shared within 48 hours</span>
                            </li>
                            <li style="padding: 0.5rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                <i class="fas fa-headset" style="color: #667eea;"></i>
                                <span>24/7 support available throughout your journey</span>
                            </li>
                        </ul>
                    </div>
                    
                    <button type="button" class="btn btn-primary" onclick="location.reload()">
                        <i class="fas fa-plus"></i> Book Another Trip
                    </button>
                </div>
            </div>

            <!-- Form Navigation -->
            <div class="form-actions">
                <button type="button" id="prevBtn" class="btn btn-secondary" style="display: none;">
                    <i class="fas fa-arrow-left"></i> Previous
                </button>
                <button type="button" id="nextBtn" class="btn btn-primary">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </form>
    </div>

    <!-- Loading Spinner -->
    <div class="loading" id="loadingSpinner">
        <div class="spinner"></div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span id="notificationText"></span>
    </div>

    <script>
        // Global variables
        let currentStep = 1;
        const totalSteps = 5;
        let selectedPackageData = null;
        let formData = {};

        // Package data with Indian pricing
        const packages = {
            basic: { 
                name: 'Essential Journey', 
                price: 75000, 
                originalPrice: 89000,
                features: ['Round-trip flights', '3-star hotel accommodation', 'Airport transfers', 'Basic travel insurance', 'Welcome kit'],
                badge: 'Popular Choice',
                discount: '16% OFF'
            },
            premium: { 
                name: 'Deluxe Experience', 
                price: 125000, 
                originalPrice: 149000,
                features: ['Premium economy flights', '4-star luxury hotel', 'All transfers included', 'Guided city tours', 'Comprehensive insurance', 'Daily breakfast', 'Local SIM card', '24/7 support'],
                badge: 'Best Value',
                discount: '16% OFF'
            },
            luxury: { 
                name: 'Royal Escape', 
                price: 199000, 
                originalPrice: 239000,
                features: ['Business class flights', '5-star luxury resort', 'Private chauffeur service', 'Personal tour guide', 'Premium travel insurance', 'All meals included', 'Spa treatments', 'VIP lounge access', 'Exclusive experiences'],
                badge: 'Ultimate Luxury',
                discount: '17% OFF'
            }
        };

        // Initialize form when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeForm();
            setupEventListeners();
            updateNavigationButtons();
        });

        // Initialize form
        function initializeForm() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('departureDate').setAttribute('min', today);
            document.getElementById('returnDate').setAttribute('min', today);

            // Load saved data if available
            loadFormData();
        }

        // Setup all event listeners
        function setupEventListeners() {
            // Traveler counter buttons
            document.getElementById('decreaseBtn').addEventListener('click', function() {
                changeTravelers(-1);
            });
            
            document.getElementById('increaseBtn').addEventListener('click', function() {
                changeTravelers(1);
            });

            // Package selection
            document.getElementById('basicPackage').addEventListener('click', function() {
                selectPackage('basic');
            });
            
            document.getElementById('premiumPackage').addEventListener('click', function() {
                selectPackage('premium');
            });
            
            document.getElementById('luxuryPackage').addEventListener('click', function() {
                selectPackage('luxury');
            });

            // Navigation buttons
            document.getElementById('nextBtn').addEventListener('click', nextStep);
            document.getElementById('prevBtn').addEventListener('click', previousStep);

            // Destination dropdown
            document.getElementById('destination').addEventListener('change', function() {
                const customGroup = document.getElementById('customDestinationGroup');
                if (this.value === 'custom') {
                    customGroup.style.display = 'block';
                    document.getElementById('customDestination').required = true;
                } else {
                    customGroup.style.display = 'none';
                    document.getElementById('customDestination').required = false;
                }
                saveFormData();
            });

            // Date inputs
            document.getElementById('departureDate').addEventListener('change', function() {
                const departureDate = new Date(this.value);
                departureDate.setDate(departureDate.getDate() + 1);
                const minReturnDate = departureDate.toISOString().split('T')[0];
                document.getElementById('returnDate').setAttribute('min', minReturnDate);
                saveFormData();
            });

            document.getElementById('returnDate').addEventListener('change', saveFormData);

            // Card number formatting
            document.getElementById('cardNumber').addEventListener('input', function() {
                let value = this.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
                let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
                if (formattedValue.length > 19) formattedValue = formattedValue.substr(0, 19);
                this.value = formattedValue;
                saveFormData();
            });

            // Expiry date formatting
            document.getElementById('expiryDate').addEventListener('input', function() {
                let value = this.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
                this.value = value;
                saveFormData();
            });

            // Auto-save for all inputs
            const inputs = document.querySelectorAll('input, select, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', saveFormData);
                input.addEventListener('change', saveFormData);
            });
        }

        // Change number of travelers
        function changeTravelers(change) {
            const countElement = document.getElementById('travelerCount');
            const hiddenInput = document.getElementById('travelers');
            let currentCount = parseInt(countElement.textContent);
            
            currentCount += change;
            
            // Keep count within bounds
            if (currentCount < 1) currentCount = 1;
            if (currentCount > 10) currentCount = 10;
            
            countElement.textContent = currentCount;
            hiddenInput.value = currentCount;
            
            // Update button states
            document.getElementById('decreaseBtn').disabled = currentCount <= 1;
            document.getElementById('increaseBtn').disabled = currentCount >= 10;
            
            saveFormData();
            showNotification(`Updated to ${currentCount} traveler(s)`, 'success');
        }

        // Select package
        function selectPackage(packageType) {
            // Remove selection from all cards
            document.querySelectorAll('.package-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selection to clicked card
            document.getElementById(packageType + 'Package').classList.add('selected');
            
            // Update selected package data
            selectedPackageData = packages[packageType];
            document.getElementById('selectedPackage').value = packageType;
            
            saveFormData();
            showNotification('Package selected: ' + selectedPackageData.name, 'success');
        }

        // Navigate to next step
        function nextStep() {
            if (validateCurrentStep()) {
                saveFormData();
                
                if (currentStep < totalSteps) {
                    // Hide current step
                    document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.remove('active');
                    document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                    document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('completed');
                    
                    // Show next step
                    currentStep++;
                    document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.add('active');
                    document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                    
                    // Update navigation buttons
                    updateNavigationButtons();
                    
                    // Special handling for step 4 (review)
                    if (currentStep === 4) {
                        generateBookingSummary();
                    }
                    
                    // Special handling for step 5 (confirmation)
                    if (currentStep === 5) {
                        processBooking();
                    }
                    
                    showNotification(`Moved to step ${currentStep}`, 'success');
                }
            }
        }

        // Navigate to previous step
        function previousStep() {
            if (currentStep > 1) {
                // Hide current step
                document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.remove('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('active');
                
                // Show previous step
                currentStep--;
                document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.add('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.add('active');
                document.querySelector(`.step[data-step="${currentStep}"]`).classList.remove('completed');
                
                // Update navigation buttons
                updateNavigationButtons();
                
                showNotification(`Moved back to step ${currentStep}`, 'success');
            }
        }

        // Update navigation button states
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.style.display = currentStep > 1 ? 'inline-flex' : 'none';
            
            if (currentStep === totalSteps) {
                nextBtn.style.display = 'none';
            } else if (currentStep === totalSteps - 1) {
                nextBtn.innerHTML = '<i class="fas fa-credit-card"></i> Complete Booking';
            } else {
                nextBtn.innerHTML = 'Next <i class="fas fa-arrow-right"></i>';
                nextBtn.style.display = 'inline-flex';
            }
        }

        // Validate current step
        function validateCurrentStep() {
            const currentStepElement = document.querySelector(`.form-step[data-step="${currentStep}"]`);
            const requiredFields = currentStepElement.querySelectorAll('[required]');
            
            for (let field of requiredFields) {
                if (!field.value.trim()) {
                    field.focus();
                    showNotification('Please fill in all required fields', 'error');
                    return false;
                }
            }
            
            // Step-specific validations
            if (currentStep === 1) {
                return validateStep1();
            } else if (currentStep === 2) {
                return validateStep2();
            } else if (currentStep === 3) {
                return validateStep3();
            } else if (currentStep === 4) {
                return validateStep4();
            }
            
            return true;
        }

        // Validate step 1
        function validateStep1() {
            const destination = document.getElementById('destination').value;
            const customDestination = document.getElementById('customDestination').value;
            const departureDate = new Date(document.getElementById('departureDate').value);
            const returnDate = new Date(document.getElementById('returnDate').value);
            
            if (destination === 'custom' && !customDestination.trim()) {
                showNotification('Please enter a custom destination', 'error');
                return false;
            }
            
            if (returnDate <= departureDate) {
                showNotification('Return date must be after departure date', 'error');
                return false;
            }
            
            return true;
        }

        // Validate step 2
        function validateStep2() {
            if (!selectedPackageData) {
                showNotification('Please select a package', 'error');
                return false;
            }
            return true;
        }

        // Validate step 3
        function validateStep3() {
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            
            if (!isValidEmail(email)) {
                showNotification('Please enter a valid email address', 'error');
                return false;
            }
            
            if (!isValidPhone(phone)) {
                showNotification('Please enter a valid phone number', 'error');
                return false;
            }
            
            return true;
        }

        // Validate step 4
        function validateStep4() {
            const cardNumber = document.getElementById('cardNumber').value.replace(/\s/g, '');
            const expiryDate = document.getElementById('expiryDate').value;
            const cvv = document.getElementById('cvv').value;
            const termsAccepted = document.getElementById('termsAccepted').checked;
            
            if (cardNumber.length < 13 || cardNumber.length > 19) {
                showNotification('Please enter a valid card number', 'error');
                return false;
            }
            
            if (!/^\d{2}\/\d{2}$/.test(expiryDate)) {
                showNotification('Please enter expiry date in MM/YY format', 'error');
                return false;
            }
            
            if (cvv.length < 3 || cvv.length > 4) {
                showNotification('Please enter a valid CVV', 'error');
                return false;
            }
            
            if (!termsAccepted) {
                showNotification('Please accept the terms and conditions', 'error');
                return false;
            }
            
            return true;
        }

        // Generate booking summary
        function generateBookingSummary() {
            const destination = document.getElementById('destination').value === 'custom' 
                ? document.getElementById('customDestination').value 
                : document.getElementById('destination').options[document.getElementById('destination').selectedIndex].text;
            
            const departureDate = new Date(document.getElementById('departureDate').value).toLocaleDateString();
            const returnDate = new Date(document.getElementById('returnDate').value).toLocaleDateString();
            const travelers = document.getElementById('travelers').value;
            
            const basePrice = selectedPackageData.price;
            const totalPrice = basePrice * parseInt(travelers);
            const taxes = Math.round(totalPrice * 0.18); // 18% GST
            const finalTotal = totalPrice + taxes;
            
            const summaryHTML = `
                <div class="summary-item">
                    <span><strong>Destination:</strong></span>
                    <span>${destination}</span>
                </div>
                <div class="summary-item">
                    <span><strong>Travel Dates:</strong></span>
                    <span>${departureDate} - ${returnDate}</span>
                </div>
                <div class="summary-item">
                    <span><strong>Package:</strong></span>
                    <span>${selectedPackageData.name}</span>
                </div>
                <div class="summary-item">
                    <span><strong>Travelers:</strong></span>
                    <span>${travelers} person(s)</span>
                </div>
                <div class="summary-item">
                    <span><strong>Package Price:</strong></span>
                    <span>₹${basePrice.toLocaleString('en-IN')} × ${travelers} = ₹${totalPrice.toLocaleString('en-IN')}</span>
                </div>
                <div class="summary-item">
                    <span><strong>GST (18%):</strong></span>
                    <span>₹${taxes.toLocaleString('en-IN')}</span>
                </div>
                <div class="summary-item total">
                    <span><strong>Total Amount:</strong></span>
                    <span><strong>₹${finalTotal.toLocaleString('en-IN')}</strong></span>
                </div>
            `;
            
            document.getElementById('bookingSummaryContent').innerHTML = summaryHTML;
        }

        // Process booking
        function processBooking() {
            showLoading();
            
            // Generate booking reference
            const bookingRef = 'TRP-' + new Date().getFullYear() + '-' + Math.random().toString().substr(2, 6);
            document.getElementById('bookingRef').textContent = bookingRef;
            
            // Save complete booking data
            const completedBooking = {
                ...formData,
                bookingReference: bookingRef,
                bookingDate: new Date().toISOString(),
                status: 'confirmed'
            };
            
            // Store in memory
            window.completedBookings = window.completedBookings || [];
            window.completedBookings.push(completedBooking);
            
            // Clear form data
            window.tempFormData = null;
            
            setTimeout(() => {
                hideLoading();
                showNotification('Booking confirmed successfully!', 'success');
            }, 2000);
        }

        // Save form data to memory
        function saveFormData() {
            const form = document.getElementById('bookingForm');
            const formDataObj = new FormData(form);
            
            formData = {};
            for (let [key, value] of formDataObj.entries()) {
                formData[key] = value;
            }
            
            // Add additional data
            formData.travelers = document.getElementById('travelers').value;
            formData.selectedPackageData = selectedPackageData;
            formData.currentStep = currentStep;
            
            // Store in memory
            window.tempFormData = formData;
        }

        // Load form data from memory
        function loadFormData() {
            if (window.tempFormData) {
                formData = window.tempFormData;
                
                // Restore form values
                for (let [key, value] of Object.entries(formData)) {
                    const element = document.getElementById(key);
                    if (element && typeof value === 'string') {
                        element.value = value;
                    }
                }
                
                // Restore travelers count
                if (formData.travelers) {
                    document.getElementById('travelerCount').textContent = formData.travelers;
                    document.getElementById('travelers').value = formData.travelers;
                }
                
                // Restore selected package
                if (formData.selectedPackageData) {
                    selectedPackageData = formData.selectedPackageData;
                }
            }
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Show loading spinner
        function showLoading() {
            document.getElementById('loadingSpinner').style.display = 'flex';
        }

        // Hide loading spinner
        function hideLoading() {
            document.getElementById('loadingSpinner').style.display = 'none';
        }

        // Utility functions
        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function isValidPhone(phone) {
            return /^[\+]?[1-9][\d]{0,15}$/.test(phone.replace(/[\s\-\(\)]/g, ''));
        }
    </script>
</body>
</html>